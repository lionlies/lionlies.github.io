<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="寄信功能app/views/layout/mailer.text.erb 是做什麼的？生成 text 格式。也可以是 mailer.html.erb，如此就是生成 html 格式。
&amp;lt;%= link_to(“訂單連結”, order_url(@order.token)) %&amp;gt; 的 url 是什麼？這邊代表絕對路徑
rails mailer 介紹http://guides.rubyonr">
<meta property="og:type" content="article">
<meta property="og:title" content="Rails EC Week 3">
<meta property="og:url" content="http://yoursite.com/2016/09/18/Rails-EC-Week-3/index.html">
<meta property="og:site_name" content="jason's blog">
<meta property="og:description" content="寄信功能app/views/layout/mailer.text.erb 是做什麼的？生成 text 格式。也可以是 mailer.html.erb，如此就是生成 html 格式。
&amp;lt;%= link_to(“訂單連結”, order_url(@order.token)) %&amp;gt; 的 url 是什麼？這邊代表絕對路徑
rails mailer 介紹http://guides.rubyonr">
<meta property="og:updated_time" content="2016-09-18T09:53:04.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Rails EC Week 3">
<meta name="twitter:description" content="寄信功能app/views/layout/mailer.text.erb 是做什麼的？生成 text 格式。也可以是 mailer.html.erb，如此就是生成 html 格式。
&amp;lt;%= link_to(“訂單連結”, order_url(@order.token)) %&amp;gt; 的 url 是什麼？這邊代表絕對路徑
rails mailer 介紹http://guides.rubyonr">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    }
  };
</script>





  <title> Rails EC Week 3 | jason's blog </title>
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="en">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">jason's blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">rails and js notes</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Rails EC Week 3
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-09-18T17:49:29+08:00" content="2016-09-18">
              2016-09-18
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/09/18/Rails-EC-Week-3/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/09/18/Rails-EC-Week-3/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="寄信功能"><a href="#寄信功能" class="headerlink" title="寄信功能"></a>寄信功能</h1><h2 id="app-views-layout-mailer-text-erb-是做什麼的？"><a href="#app-views-layout-mailer-text-erb-是做什麼的？" class="headerlink" title="app/views/layout/mailer.text.erb 是做什麼的？"></a>app/views/layout/mailer.text.erb 是做什麼的？</h2><p>生成 text 格式。也可以是 <code>mailer.html.erb</code>，如此就是生成 html 格式。</p>
<h2 id="lt-link-to-“訂單連結”-order-url-order-token-gt-的-url-是什麼？"><a href="#lt-link-to-“訂單連結”-order-url-order-token-gt-的-url-是什麼？" class="headerlink" title="&lt;%= link_to(“訂單連結”, order_url(@order.token)) %&gt; 的 url 是什麼？"></a>&lt;%= link_to(“訂單連結”, order_url(@order.token)) %&gt; 的 url 是什麼？</h2><p>這邊代表絕對路徑</p>
<h2 id="rails-mailer-介紹"><a href="#rails-mailer-介紹" class="headerlink" title="rails mailer 介紹"></a>rails mailer 介紹</h2><p><a href="http://guides.rubyonrails.org/action_mailer_basics.html" target="_blank" rel="external">http://guides.rubyonrails.org/action_mailer_basics.html</a><br><a href="http://api.rubyonrails.org/classes/ActionMailer/Base.html" target="_blank" rel="external">http://api.rubyonrails.org/classes/ActionMailer/Base.html</a><br><a href="https://ihower.tw/rails4/actionmailer.html" target="_blank" rel="external">https://ihower.tw/rails4/actionmailer.html</a></p>
<h2 id="下面這段"><a href="#下面這段" class="headerlink" title="下面這段"></a>下面這段</h2><p><code>config.action_mailer.default_url_options = { host: &#39;localhost:3000&#39; }</code><br><code>config.action_mailer.delivery_method = :letter_opener</code><br>是怎麼來的？為什麼這樣寫？letter_opener 的 READM.md 沒看到相關內容，要去哪裡找？</p>
<blockquote>
<p>tba</p>
</blockquote>
<h2 id="拆解-OrderMailer-notify-order-placed-Order-last-deliver"><a href="#拆解-OrderMailer-notify-order-placed-Order-last-deliver" class="headerlink" title="拆解 OrderMailer.notify_order_placed(Order.last).deliver!"></a>拆解 OrderMailer.notify_order_placed(Order.last).deliver!</h2><blockquote>
<p>tba</p>
</blockquote>
<h2 id="做什麼？"><a href="#做什麼？" class="headerlink" title=" 做什麼？"></a><link rel="stylesheet" type="text/css" href="/assets/application.css"> 做什麼？</h2><blockquote>
<p>tba</p>
</blockquote>
<h2 id="find-by-id-session-cart-id-可以寫成-find-by-id-session-cart-id-，那-mail-to-user-email-subject-“blahblahblah”-可不可以寫成-mail-to-user-email-subject-“blahblahblah”"><a href="#find-by-id-session-cart-id-可以寫成-find-by-id-session-cart-id-，那-mail-to-user-email-subject-“blahblahblah”-可不可以寫成-mail-to-user-email-subject-“blahblahblah”" class="headerlink" title="find_by_id(session[:cart_id]) 可以寫成 find_by(id: session[:cart_id])，那 mail(to: @user.email, subject: “blahblahblah”) 可不可以寫成 mail_to(@user.email, subject: “blahblahblah”) ?"></a>find_by_id(session[:cart_id]) 可以寫成 find_by(id: session[:cart_id])，那 mail(to: @user.email, subject: “blahblahblah”) 可不可以寫成 mail_to(@user.email, subject: “blahblahblah”) ?</h2><blockquote>
<p>tba</p>
</blockquote>
<h1 id="金流功能"><a href="#金流功能" class="headerlink" title="金流功能"></a>金流功能</h1><h2 id="‘pay2go’-gem-是做什麼的？"><a href="#‘pay2go’-gem-是做什麼的？" class="headerlink" title="‘pay2go’ gem 是做什麼的？"></a>‘pay2go’ gem 是做什麼的？</h2><blockquote>
<p>tba</p>
</blockquote>
<h2 id="投影片-“Step-2-設定整合模式gem”。什麼是”整合模式”？下面整合模式的寫法，是預先定義在-‘pay2go’-gem-中，還是這是-rails-接-gem-的固定方式？"><a href="#投影片-“Step-2-設定整合模式gem”。什麼是”整合模式”？下面整合模式的寫法，是預先定義在-‘pay2go’-gem-中，還是這是-rails-接-gem-的固定方式？" class="headerlink" title="投影片 “Step 2: 設定整合模式gem”。什麼是”整合模式”？下面整合模式的寫法，是預先定義在 ‘pay2go’ gem 中，還是這是 rails 接 gem 的固定方式？"></a>投影片 “Step 2: 設定整合模式gem”。什麼是”整合模式”？下面整合模式的寫法，是預先定義在 ‘pay2go’ gem 中，還是這是 rails 接 gem 的固定方式？</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">config.after_initialize do</div><div class="line">  Pay2go.integration_mode = :development</div><div class="line">end</div><div class="line"></div><div class="line">config.after_initialize do</div><div class="line">  Pay2go.integration_mode = :production</div><div class="line">end</div></pre></td></tr></table></figure>
<p><a href="http://guides.rubyonrails.org/configuring.html" target="_blank" rel="external">http://guides.rubyonrails.org/configuring.html</a>  3 Configuring Rails Components<br>上面找不到 integration_mode 的內容。</p>
<h2 id="沒有-Pay2go-class，為什麼可以-Pay2go-integration-mode-或是-Pay2go-setup-do-pay2go-這樣的寫法？"><a href="#沒有-Pay2go-class，為什麼可以-Pay2go-integration-mode-或是-Pay2go-setup-do-pay2go-這樣的寫法？" class="headerlink" title="沒有 Pay2go class，為什麼可以 Pay2go.integration_mode 或是 Pay2go.setup do |pay2go| 這樣的寫法？"></a>沒有 Pay2go class，為什麼可以 Pay2go.integration_mode 或是 Pay2go.setup do |pay2go| 這樣的寫法？</h2><blockquote>
<p>tba</p>
</blockquote>
<h2 id="pay2go-rb-的位置在-config-initializers-pay2go-rb，這跟前面幾題使用-after-initialize-有關嗎？還是這是智付寶指定要放的位置？"><a href="#pay2go-rb-的位置在-config-initializers-pay2go-rb，這跟前面幾題使用-after-initialize-有關嗎？還是這是智付寶指定要放的位置？" class="headerlink" title="pay2go.rb 的位置在 config/initializers/pay2go.rb，這跟前面幾題使用 after_initialize 有關嗎？還是這是智付寶指定要放的位置？"></a>pay2go.rb 的位置在 config/initializers/pay2go.rb，這跟前面幾題使用 after_initialize 有關嗎？還是這是智付寶指定要放的位置？</h2><blockquote>
<p>tba</p>
</blockquote>
<h2 id="為什麼整合模式寫在-config-environments-development-rb-及-config-environments-production-rb"><a href="#為什麼整合模式寫在-config-environments-development-rb-及-config-environments-production-rb" class="headerlink" title="為什麼整合模式寫在 config/environments/development.rb 及 config/environments/production.rb ?"></a>為什麼整合模式寫在 config/environments/development.rb 及 config/environments/production.rb ?</h2><blockquote>
<p>tba</p>
</blockquote>
<h2 id="config-environments-config-initializers-config-locales……等檔案夾，是-rails-有-convention-指定要放什麼類型的檔案？還是說第三方服務的-API-可以指定放哪裡？如果是後者，那第三方-API-可不可以指定放在新增的檔案夾，比如說-config-pay2go-檔案夾裡面？pay2go-service-rb-放在-app-services-pay2go-service-rb-是-pay2go-api-的規定嗎？"><a href="#config-environments-config-initializers-config-locales……等檔案夾，是-rails-有-convention-指定要放什麼類型的檔案？還是說第三方服務的-API-可以指定放哪裡？如果是後者，那第三方-API-可不可以指定放在新增的檔案夾，比如說-config-pay2go-檔案夾裡面？pay2go-service-rb-放在-app-services-pay2go-service-rb-是-pay2go-api-的規定嗎？" class="headerlink" title="config/environments, config/initializers, config/locales……等檔案夾，是 rails 有 convention 指定要放什麼類型的檔案？還是說第三方服務的 API 可以指定放哪裡？如果是後者，那第三方 API 可不可以指定放在新增的檔案夾，比如說 config/pay2go 檔案夾裡面？pay2go_service.rb 放在 app/services/pay2go_service.rb 是 pay2go api 的規定嗎？"></a>config/environments, config/initializers, config/locales……等檔案夾，是 rails 有 convention 指定要放什麼類型的檔案？還是說第三方服務的 API 可以指定放哪裡？如果是後者，那第三方 API 可不可以指定放在新增的檔案夾，比如說 config/pay2go 檔案夾裡面？pay2go_service.rb 放在 app/services/pay2go_service.rb 是 pay2go api 的規定嗎？</h2><p>&gt;</p>
<h2 id="上述哪些寫法是-Rails-指定的？哪些是-“pay2go”-gem-指定的？哪些是-Pay2go-API-指定的？"><a href="#上述哪些寫法是-Rails-指定的？哪些是-“pay2go”-gem-指定的？哪些是-Pay2go-API-指定的？" class="headerlink" title="上述哪些寫法是 Rails 指定的？哪些是 “pay2go” gem 指定的？哪些是 Pay2go API 指定的？"></a>上述哪些寫法是 Rails 指定的？哪些是 “pay2go” gem 指定的？哪些是 Pay2go API 指定的？</h2><p>&gt;</p>
<h2 id="有哪些功能來自-pay2go-api-哪些來自-pay2go-gem"><a href="#有哪些功能來自-pay2go-api-哪些來自-pay2go-gem" class="headerlink" title="有哪些功能來自 pay2go api? 哪些來自 pay2go gem?"></a>有哪些功能來自 pay2go api? 哪些來自 pay2go gem?</h2><p>&gt;</p>
<h2 id="form-tag-hidden-field-tag-submit-tag-各是什麼？"><a href="#form-tag-hidden-field-tag-submit-tag-各是什麼？" class="headerlink" title="form_tag, hidden_field_tag, submit_tag 各是什麼？"></a>form_tag, hidden_field_tag, submit_tag 各是什麼？</h2><p><a href="http://stackoverflow.com/questions/7733085/rails-what-exactly-does-hidden-field-and-hidden-field-tag-do" target="_blank" rel="external">http://stackoverflow.com/questions/7733085/rails-what-exactly-does-hidden-field-and-hidden-field-tag-do</a></p>
<h2 id="callbacks-有什麼用途？這是來自-pay2go-伺服端的回應，還是就只是個我們寫在程式裡的小提示而已？"><a href="#callbacks-有什麼用途？這是來自-pay2go-伺服端的回應，還是就只是個我們寫在程式裡的小提示而已？" class="headerlink" title="callbacks 有什麼用途？這是來自 pay2go 伺服端的回應，還是就只是個我們寫在程式裡的小提示而已？"></a>callbacks 有什麼用途？這是來自 pay2go 伺服端的回應，還是就只是個我們寫在程式裡的小提示而已？</h2><p>&gt;</p>
<h2 id="protect-from-forgery"><a href="#protect-from-forgery" class="headerlink" title="protect_from_forgery"></a>protect_from_forgery</h2><p><a href="http://api.rubyonrails.org/classes/ActionController/RequestForgeryProtection/ClassMethods.html" target="_blank" rel="external">http://api.rubyonrails.org/classes/ActionController/RequestForgeryProtection/ClassMethods.html</a><br><a href="http://stackoverflow.com/questions/1177863/how-do-i-ignore-the-authenticity-token-for-specific-actions-in-rails" target="_blank" rel="external">http://stackoverflow.com/questions/1177863/how-do-i-ignore-the-authenticity-token-for-specific-actions-in-rails</a></p>
<h2 id="下面-initialize-method-是做什麼的？"><a href="#下面-initialize-method-是做什麼的？" class="headerlink" title="下面 initialize method 是做什麼的？"></a>下面 initialize method 是做什麼的？</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">class Pay2goService</div><div class="line"></div><div class="line">  def initialize(order)</div><div class="line">    @order = order</div><div class="line">    @timestamp = order.created_at.to_i</div><div class="line">    @merchant_order_no = &quot;#&#123;order.id&#125;s#&#123;Time.now.strftime(&quot;%Y%m%d%H%M%S&quot;)&#125;&quot;</div><div class="line">    @total_price = order.total</div><div class="line">  end</div><div class="line">  ......</div></pre></td></tr></table></figure>
<p>&gt;</p>
<h2 id="pay2go-cc-notify-order-url-order-token-怎麼來的？"><a href="#pay2go-cc-notify-order-url-order-token-怎麼來的？" class="headerlink" title="pay2go_cc_notify_order_url(order.token) 怎麼來的？"></a>pay2go_cc_notify_order_url(order.token) 怎麼來的？</h2><p>&gt;</p>
<h2 id="在寫-pay-with-credit-card-html-erb-時，那些掛在-hidden-field-tag-後面的東西是哪裡來的？"><a href="#在寫-pay-with-credit-card-html-erb-時，那些掛在-hidden-field-tag-後面的東西是哪裡來的？" class="headerlink" title="在寫 _pay_with_credit_card.html.erb 時，那些掛在 hidden _field _tag 後面的東西是哪裡來的？"></a>在寫 <code>_pay_with_credit_card.html.erb</code> 時，那些掛在 hidden <code>_field _tag</code> 後面的東西是哪裡來的？</h2><p>&gt;</p>
<h2 id="before-action-authenticate-user-except-pay2go-cc-notify-的-except-pay2go-cc-notify"><a href="#before-action-authenticate-user-except-pay2go-cc-notify-的-except-pay2go-cc-notify" class="headerlink" title="before_action :authenticate_user!, except: :pay2go_cc_notify 的 except: :pay2go_cc_notify"></a>before_action :authenticate_user!, except: :pay2go_cc_notify 的 except: :pay2go_cc_notify</h2><p>&gt;</p>
<h2 id="lt-render-“pay-with-credit-card”-order-order-gt-的-order-order"><a href="#lt-render-“pay-with-credit-card”-order-order-gt-的-order-order" class="headerlink" title="&lt;%= render “pay_with_credit_card”, order: @order %&gt; 的 order: @order"></a>&lt;%= render “pay_with_credit_card”, order: @order %&gt; 的 order: @order</h2><p>&gt;</p>
<h2 id="為什麼-pay-with-credit-card-這個-partial-在按下按鈕時能產生用信用卡付款的效果？"><a href="#為什麼-pay-with-credit-card-這個-partial-在按下按鈕時能產生用信用卡付款的效果？" class="headerlink" title="為什麼 _pay_with_credit_card 這個 partial 在按下按鈕時能產生用信用卡付款的效果？"></a>為什麼 <code>_pay_with_credit_card</code> 這個 partial 在按下按鈕時能產生用信用卡付款的效果？</h2><p>&gt;</p>
<h2 id="pay2go-cc-notify-method-是什麼時候被執行而能產生-callback-的效果？"><a href="#pay2go-cc-notify-method-是什麼時候被執行而能產生-callback-的效果？" class="headerlink" title="pay2go_cc_notify method 是什麼時候被執行而能產生 callback 的效果？"></a>pay2go_cc_notify method 是什麼時候被執行而能產生 callback 的效果？</h2><p>&gt;</p>
<h2 id="lt-hidden-field-tag-“ReturnURL”-pay2go-cc-notify-order-url-order-token-gt"><a href="#lt-hidden-field-tag-“ReturnURL”-pay2go-cc-notify-order-url-order-token-gt" class="headerlink" title="&lt;%= hidden_field_tag “ReturnURL”, pay2go_cc_notify_order_url(order.token) %&gt;"></a>&lt;%= hidden_field_tag “ReturnURL”, pay2go_cc_notify_order_url(order.token) %&gt;</h2><p>為什麼 pay2go_cc_notify_order_url 後面要套入 order.token 這個參數？</p>
<p>&gt;</p>
<h2 id="if-params-“Status”-“SUCCESS”-是-Pay2go-API-回傳的資訊嗎？"><a href="#if-params-“Status”-“SUCCESS”-是-Pay2go-API-回傳的資訊嗎？" class="headerlink" title="if params[“Status”] == “SUCCESS” 是 Pay2go API 回傳的資訊嗎？"></a>if params[“Status”] == “SUCCESS” 是 Pay2go API 回傳的資訊嗎？</h2><p>params[“status”] 似乎是 hash 結構，這 hash 來自哪裡？怎麼存？</p>
<p>是的，來自Pay2go API，所以沒什麼 local 端怎麼存的問題。</p>
<ul>
<li>下面這段：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">class OrdersController &lt; ApplicationController</div><div class="line">......</div><div class="line">  def create</div><div class="line">  ......</div><div class="line">      current_cart.clean!</div><div class="line">      OrderMailer.notify_order_placed(Order.last).deliver!</div><div class="line">      ......</div></pre></td></tr></table></figure>
<p>其中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">current_cart.clean!</div><div class="line">OrderMailer.notify_order_placed(Order.last).deliver!</div></pre></td></tr></table></figure>
<p>這兩行的先後順序有沒有影響到什麼東西？比如說使用者體驗、效能之類的？</p>
<p>&gt;</p>
<h2 id="local-git-和-heroku-git-不同，要改的話，用下面的連結。"><a href="#local-git-和-heroku-git-不同，要改的話，用下面的連結。" class="headerlink" title="local git 和 heroku git 不同，要改的話，用下面的連結。"></a>local git 和 heroku git 不同，要改的話，用下面的連結。</h2><p><a href="http://stackoverflow.com/questions/28749771/cant-push-to-heroku-after-accidentally-deleting-app-on-heroku" target="_blank" rel="external">http://stackoverflow.com/questions/28749771/cant-push-to-heroku-after-accidentally-deleting-app-on-heroku</a><br><a href="http://stackoverflow.com/questions/20263321/git-push-heroku-master-not-working" target="_blank" rel="external">http://stackoverflow.com/questions/20263321/git-push-heroku-master-not-working</a></p>
<h1 id="Deploy-到-Heroku"><a href="#Deploy-到-Heroku" class="headerlink" title="Deploy 到 Heroku"></a>Deploy 到 Heroku</h1><h2 id="gem-“pg”-是-heroku-指定的-database，並且必須限定在-production-下使用。"><a href="#gem-“pg”-是-heroku-指定的-database，並且必須限定在-production-下使用。" class="headerlink" title="gem “pg” 是 heroku 指定的 database，並且必須限定在 production 下使用。"></a>gem “pg” 是 heroku 指定的 database，並且必須限定在 production 下使用。</h2><ul>
<li>4 of 9</li>
</ul>
<p>Gemfile中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gem &apos;sqlite3&apos;, group: :development</div></pre></td></tr></table></figure></p>
<p>也可以寫成<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">group: :development do</div><div class="line">  gem &apos;sqlite3&apos;</div><div class="line">end</div></pre></td></tr></table></figure></p>
<p>就像該slide下方production的寫法</p>
<p>[補充] 在 Rails 5 中，如果不把 gem “sqlite” 放在 development 及 test 中，只放在 development mode, 好像會造成 deploy 到 heroku 時出問題。</p>
<h2 id="Gemfile-中，production-包在-development-test-這層-scope-內也能運作，但會有什麼影響呢？"><a href="#Gemfile-中，production-包在-development-test-這層-scope-內也能運作，但會有什麼影響呢？" class="headerlink" title="Gemfile 中，production 包在 development, test 這層 scope 內也能運作，但會有什麼影響呢？"></a>Gemfile 中，production 包在 development, test 這層 scope 內也能運作，但會有什麼影響呢？</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">group :development, :test do</div><div class="line">  gem &apos;byebug&apos;</div><div class="line">  gem &apos;web-console&apos;, &apos;~&gt; 2.0&apos;</div><div class="line">  gem &apos;spring&apos;</div><div class="line"></div><div class="line">  group :production do</div><div class="line">    gem &quot;pg&quot;</div><div class="line">    gem &quot;rails_12factor&quot;</div><div class="line">  end</div><div class="line">end</div></pre></td></tr></table></figure>
<p>&gt;</p>
<h2 id="“因為我們還要測試在-heroku-的刷卡機制，所以先暫時把-production-裡的-pay2go-環境設定改成開發用”。這個修改對於-heroku-端有什麼影響？因為不是說程式部署到-heroku-會自動變成-production-模式嗎？"><a href="#“因為我們還要測試在-heroku-的刷卡機制，所以先暫時把-production-裡的-pay2go-環境設定改成開發用”。這個修改對於-heroku-端有什麼影響？因為不是說程式部署到-heroku-會自動變成-production-模式嗎？" class="headerlink" title="“因為我們還要測試在 heroku 的刷卡機制，所以先暫時把 production 裡的 pay2go 環境設定改成開發用”。這個修改對於 heroku 端有什麼影響？因為不是說程式部署到 heroku 會自動變成 production 模式嗎？"></a>“因為我們還要測試在 heroku 的刷卡機制，所以先暫時把 production 裡的 pay2go 環境設定改成開發用”。這個修改對於 heroku 端有什麼影響？因為不是說程式部署到 heroku 會自動變成 production 模式嗎？</h2><p>&gt;</p>
<h2 id="Deploying-with-git-https-devcenter-heroku-com-articles-git"><a href="#Deploying-with-git-https-devcenter-heroku-com-articles-git" class="headerlink" title="Deploying with git https://devcenter.heroku.com/articles/git"></a>Deploying with git <a href="https://devcenter.heroku.com/articles/git" target="_blank" rel="external">https://devcenter.heroku.com/articles/git</a></h2><p><br><br><br></p>
<h1 id="Deploy-補充-環境架構解說"><a href="#Deploy-補充-環境架構解說" class="headerlink" title="Deploy 補充 - 環境架構解說"></a>Deploy 補充 - 環境架構解說</h1><p>n/a<br><br><br><br></p>
<h1 id="用-figaro-管理機密資訊"><a href="#用-figaro-管理機密資訊" class="headerlink" title="用 figaro 管理機密資訊"></a>用 figaro 管理機密資訊</h1><h2 id="拆解下面這段"><a href="#拆解下面這段" class="headerlink" title="拆解下面這段"></a>拆解下面這段</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">＄ figaro install</div><div class="line">create  config/application.yml</div><div class="line">append  .gitignore</div></pre></td></tr></table></figure>
<p>下了指令後，產生config/application.yml檔，接著把這個檔案加到.gitignore的名單裡面。我們把要用figaro上傳並設定的使用者資料存在config/application.yml檔，因為它已經被加到.gitignore的名單中，所以這些使用者資料不會上傳而被別人看到。接著再透過figaro來把這些使用者資料自動灌上去。</p>
<h2 id="只要有新增、修改帳號密碼，就要跑-figaro-heroku-set-e-production-將最新的帳號密碼資訊傳到-heroku-去。"><a href="#只要有新增、修改帳號密碼，就要跑-figaro-heroku-set-e-production-將最新的帳號密碼資訊傳到-heroku-去。" class="headerlink" title="只要有新增、修改帳號密碼，就要跑 figaro heroku:set -e production 將最新的帳號密碼資訊傳到 heroku 去。"></a>只要有新增、修改帳號密碼，就要跑 <code>figaro heroku:set -e production</code> 將最新的帳號密碼資訊傳到 heroku 去。</h2><h2 id="什麼是環境變數？"><a href="#什麼是環境變數？" class="headerlink" title="什麼是環境變數？"></a>什麼是環境變數？</h2><p>&gt;</p>
<h2 id="application-yml-中的-pay2go-merchant-id-quot-197-quot-VS-pay2go-rb-中的-pay2go-merchant-id-ENV-39-pay2go-merchant-id-39-，這兩種寫法是-conventions-還是-figaro-要求的？"><a href="#application-yml-中的-pay2go-merchant-id-quot-197-quot-VS-pay2go-rb-中的-pay2go-merchant-id-ENV-39-pay2go-merchant-id-39-，這兩種寫法是-conventions-還是-figaro-要求的？" class="headerlink" title="application.yml 中的 pay2go_merchant_id: &quot;197----&quot; VS pay2go.rb 中的 pay2go.merchant_id = ENV[&#39;pay2go_merchant_id&#39;]，這兩種寫法是 conventions 還是 figaro 要求的？"></a>application.yml 中的 <code>pay2go_merchant_id: &quot;197----&quot;</code> VS pay2go.rb 中的 <code>pay2go.merchant_id = ENV[&#39;pay2go_merchant_id&#39;]</code>，這兩種寫法是 conventions 還是 figaro 要求的？</h2><p>&gt;</p>
<h1 id="更多開發技巧"><a href="#更多開發技巧" class="headerlink" title="更多開發技巧"></a>更多開發技巧</h1><h2 id="為什麼-rake-T-列出的清單中沒有-rake-db-reset"><a href="#為什麼-rake-T-列出的清單中沒有-rake-db-reset" class="headerlink" title="為什麼 rake -T 列出的清單中沒有 rake db:reset?"></a>為什麼 <code>rake -T</code> 列出的清單中沒有 <code>rake db:reset</code>?</h2><p>&gt;</p>
<h1 id="基本收納術"><a href="#基本收納術" class="headerlink" title="基本收納術"></a>基本收納術</h1><p><a href="https://rocodev.gitbooks.io/rails-102/content/chapter3-ruby/mixin_extend_inheritance.html" target="_blank" rel="external">https://rocodev.gitbooks.io/rails-102/content/chapter3-ruby/mixin_extend_inheritance.html</a></p>
<h2 id="為什麼-tokenable-rb-是放在-app-models-concerns-A-K-A-How-to-use-concerns-in-Rails-4"><a href="#為什麼-tokenable-rb-是放在-app-models-concerns-A-K-A-How-to-use-concerns-in-Rails-4" class="headerlink" title="為什麼 tokenable.rb 是放在 app/models/concerns?  A.K.A. How to use concerns in Rails 4 ?"></a>為什麼 <code>tokenable.rb</code> 是放在 <code>app/models/concerns</code>?  A.K.A. How to use concerns in Rails 4 ?</h2><p><a href="https://signalvnoise.com/posts/3372-put-chubby-models-on-a-diet-with-concerns" target="_blank" rel="external">https://signalvnoise.com/posts/3372-put-chubby-models-on-a-diet-with-concerns</a><br><a href="https://richonrails.com/articles/rails-4-code-concerns-in-active-record-models" target="_blank" rel="external">https://richonrails.com/articles/rails-4-code-concerns-in-active-record-models</a><br><a href="http://codefol.io/posts/Where-Do-I-Put-My-Code" target="_blank" rel="external">http://codefol.io/posts/Where-Do-I-Put-My-Code</a><br><a href="http://stackoverflow.com/questions/14541823/how-to-use-concerns-in-rails-4" target="_blank" rel="external">http://stackoverflow.com/questions/14541823/how-to-use-concerns-in-rails-4</a></p>
<h2 id="“一般-module-不認識-before-create，用-Rails-Model-Concern”。為什麼一般-module-不認識-before-create-concerns-分多少種？"><a href="#“一般-module-不認識-before-create，用-Rails-Model-Concern”。為什麼一般-module-不認識-before-create-concerns-分多少種？" class="headerlink" title="“一般 module 不認識 before_create，用 Rails : Model Concern”。為什麼一般 module 不認識 before_create ? concerns 分多少種？"></a>“一般 module 不認識 before_create，用 Rails : Model Concern”。為什麼一般 module 不認識 before_create ? concerns 分多少種？</h2><p>&gt;</p>
<h2 id="拆解下方："><a href="#拆解下方：" class="headerlink" title="拆解下方："></a>拆解下方：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">module Tokenable</div><div class="line">  extend ActiveRecord::Concern</div><div class="line"></div><div class="line">  included do</div><div class="line">    before_create :generate_token</div><div class="line">  end</div><div class="line"></div><div class="line">  def generate_token</div><div class="line">    self.token = SecureRandom.uuid</div><div class="line">  end</div><div class="line">end</div></pre></td></tr></table></figure>
<h1 id="View-收納術"><a href="#View-收納術" class="headerlink" title="View 收納術"></a>View 收納術</h1><p>通篇看不懂Orz</p>
<h1 id="ServiceObject"><a href="#ServiceObject" class="headerlink" title="ServiceObject"></a>ServiceObject</h1><h2 id="各個檔案裡的-method-是怎麼被找到的？比如說我們在-app-services-order-placing-service-rb-有一個-OrderPlacingService-class，底下有一個叫-place-order-的-method，然後我們在-app-controllers-orders-controller-rb-裡面用到-OrderPlacingService-new-current-cart-order-place-order-，請問是怎麼找到的？"><a href="#各個檔案裡的-method-是怎麼被找到的？比如說我們在-app-services-order-placing-service-rb-有一個-OrderPlacingService-class，底下有一個叫-place-order-的-method，然後我們在-app-controllers-orders-controller-rb-裡面用到-OrderPlacingService-new-current-cart-order-place-order-，請問是怎麼找到的？" class="headerlink" title="各個檔案裡的 method 是怎麼被找到的？比如說我們在 app/services/order_placing_service.rb 有一個 OrderPlacingService class，底下有一個叫 place_order! 的 method，然後我們在 app/controllers/orders_controller.rb 裡面用到 OrderPlacingService.new(current_cart, @order).place_order!，請問是怎麼找到的？"></a>各個檔案裡的 method 是怎麼被找到的？比如說我們在 app/services/order_placing_service.rb 有一個 OrderPlacingService class，底下有一個叫 place_order! 的 method，然後我們在 app/controllers/orders_controller.rb 裡面用到 <code>OrderPlacingService.new(current_cart, @order).place_order!</code>，請問是怎麼找到的？</h2><p>&gt;</p>
<h2 id="可不可以說，service-objects-給-controller-用、concerns-給-model-用-partial-給-view-用？helper-在-MVC-三個都可以用？"><a href="#可不可以說，service-objects-給-controller-用、concerns-給-model-用-partial-給-view-用？helper-在-MVC-三個都可以用？" class="headerlink" title="可不可以說，service objects 給 controller 用、concerns 給 model 用 partial 給 view 用？helper 在 MVC 三個都可以用？"></a>可不可以說，service objects 給 controller 用、concerns 給 model 用 partial 給 view 用？helper 在 MVC 三個都可以用？</h2><p>&gt;</p>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><h2 id="放-gem-進去-Gemfile-時，實務上會加上版本號嗎？"><a href="#放-gem-進去-Gemfile-時，實務上會加上版本號嗎？" class="headerlink" title="放 gem 進去 Gemfile 時，實務上會加上版本號嗎？"></a>放 gem 進去 Gemfile 時，實務上會加上版本號嗎？</h2><p>不一定，看 gem 的 README.md 怎麼寫。但是 ruby 和 rails 的版本好通常是會寫的，因為要讓整個 project 每個人的 ruby 及 rails 版本號是相同的。</p>
<h2 id="golden-circle-why-how-what"><a href="#golden-circle-why-how-what" class="headerlink" title="golden circle: why, how ,what?"></a>golden circle: why, how ,what?</h2><p>&gt;</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/09/18/Rails-EC-Week-2-Homework/" rel="next" title="Rails EC Week 2 Homework">
                <i class="fa fa-chevron-left"></i> Rails EC Week 2 Homework
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/09/18/Rails-EC-Week-3-Homework/" rel="prev" title="Rails EC Week 3 Homework">
                Rails EC Week 3 Homework <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Jason Lung" />
          <p class="site-author-name" itemprop="name">Jason Lung</p>
          <p class="site-description motion-element" itemprop="description">rails developer, entrepreneur</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">50</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/lionlies" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://facebook.com/lionlies" target="_blank" title="Facebook">
                  
                    <i class="fa fa-fw fa-facebook"></i>
                  
                  Facebook
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#寄信功能"><span class="nav-number">1.</span> <span class="nav-text">寄信功能</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#app-views-layout-mailer-text-erb-是做什麼的？"><span class="nav-number">1.1.</span> <span class="nav-text">app/views/layout/mailer.text.erb 是做什麼的？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#lt-link-to-“訂單連結”-order-url-order-token-gt-的-url-是什麼？"><span class="nav-number">1.2.</span> <span class="nav-text"><%= link_to(“訂單連結”, order_url(@order.token)) %> 的 url 是什麼？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rails-mailer-介紹"><span class="nav-number">1.3.</span> <span class="nav-text">rails mailer 介紹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#下面這段"><span class="nav-number">1.4.</span> <span class="nav-text">下面這段</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#拆解-OrderMailer-notify-order-placed-Order-last-deliver"><span class="nav-number">1.5.</span> <span class="nav-text">拆解 OrderMailer.notify_order_placed(Order.last).deliver!</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#做什麼？"><span class="nav-number">1.6.</span> <span class="nav-text"> 做什麼？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#find-by-id-session-cart-id-可以寫成-find-by-id-session-cart-id-，那-mail-to-user-email-subject-“blahblahblah”-可不可以寫成-mail-to-user-email-subject-“blahblahblah”"><span class="nav-number">1.7.</span> <span class="nav-text">find_by_id(session[:cart_id]) 可以寫成 find_by(id: session[:cart_id])，那 mail(to: @user.email, subject: “blahblahblah”) 可不可以寫成 mail_to(@user.email, subject: “blahblahblah”) ?</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#金流功能"><span class="nav-number">2.</span> <span class="nav-text">金流功能</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#‘pay2go’-gem-是做什麼的？"><span class="nav-number">2.1.</span> <span class="nav-text">‘pay2go’ gem 是做什麼的？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#投影片-“Step-2-設定整合模式gem”。什麼是”整合模式”？下面整合模式的寫法，是預先定義在-‘pay2go’-gem-中，還是這是-rails-接-gem-的固定方式？"><span class="nav-number">2.2.</span> <span class="nav-text">投影片 “Step 2: 設定整合模式gem”。什麼是”整合模式”？下面整合模式的寫法，是預先定義在 ‘pay2go’ gem 中，還是這是 rails 接 gem 的固定方式？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#沒有-Pay2go-class，為什麼可以-Pay2go-integration-mode-或是-Pay2go-setup-do-pay2go-這樣的寫法？"><span class="nav-number">2.3.</span> <span class="nav-text">沒有 Pay2go class，為什麼可以 Pay2go.integration_mode 或是 Pay2go.setup do |pay2go| 這樣的寫法？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pay2go-rb-的位置在-config-initializers-pay2go-rb，這跟前面幾題使用-after-initialize-有關嗎？還是這是智付寶指定要放的位置？"><span class="nav-number">2.4.</span> <span class="nav-text">pay2go.rb 的位置在 config/initializers/pay2go.rb，這跟前面幾題使用 after_initialize 有關嗎？還是這是智付寶指定要放的位置？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#為什麼整合模式寫在-config-environments-development-rb-及-config-environments-production-rb"><span class="nav-number">2.5.</span> <span class="nav-text">為什麼整合模式寫在 config/environments/development.rb 及 config/environments/production.rb ?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#config-environments-config-initializers-config-locales……等檔案夾，是-rails-有-convention-指定要放什麼類型的檔案？還是說第三方服務的-API-可以指定放哪裡？如果是後者，那第三方-API-可不可以指定放在新增的檔案夾，比如說-config-pay2go-檔案夾裡面？pay2go-service-rb-放在-app-services-pay2go-service-rb-是-pay2go-api-的規定嗎？"><span class="nav-number">2.6.</span> <span class="nav-text">config/environments, config/initializers, config/locales……等檔案夾，是 rails 有 convention 指定要放什麼類型的檔案？還是說第三方服務的 API 可以指定放哪裡？如果是後者，那第三方 API 可不可以指定放在新增的檔案夾，比如說 config/pay2go 檔案夾裡面？pay2go_service.rb 放在 app/services/pay2go_service.rb 是 pay2go api 的規定嗎？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#上述哪些寫法是-Rails-指定的？哪些是-“pay2go”-gem-指定的？哪些是-Pay2go-API-指定的？"><span class="nav-number">2.7.</span> <span class="nav-text">上述哪些寫法是 Rails 指定的？哪些是 “pay2go” gem 指定的？哪些是 Pay2go API 指定的？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#有哪些功能來自-pay2go-api-哪些來自-pay2go-gem"><span class="nav-number">2.8.</span> <span class="nav-text">有哪些功能來自 pay2go api? 哪些來自 pay2go gem?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#form-tag-hidden-field-tag-submit-tag-各是什麼？"><span class="nav-number">2.9.</span> <span class="nav-text">form_tag, hidden_field_tag, submit_tag 各是什麼？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#callbacks-有什麼用途？這是來自-pay2go-伺服端的回應，還是就只是個我們寫在程式裡的小提示而已？"><span class="nav-number">2.10.</span> <span class="nav-text">callbacks 有什麼用途？這是來自 pay2go 伺服端的回應，還是就只是個我們寫在程式裡的小提示而已？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#protect-from-forgery"><span class="nav-number">2.11.</span> <span class="nav-text">protect_from_forgery</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#下面-initialize-method-是做什麼的？"><span class="nav-number">2.12.</span> <span class="nav-text">下面 initialize method 是做什麼的？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pay2go-cc-notify-order-url-order-token-怎麼來的？"><span class="nav-number">2.13.</span> <span class="nav-text">pay2go_cc_notify_order_url(order.token) 怎麼來的？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#在寫-pay-with-credit-card-html-erb-時，那些掛在-hidden-field-tag-後面的東西是哪裡來的？"><span class="nav-number">2.14.</span> <span class="nav-text">在寫 _pay_with_credit_card.html.erb 時，那些掛在 hidden _field _tag 後面的東西是哪裡來的？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#before-action-authenticate-user-except-pay2go-cc-notify-的-except-pay2go-cc-notify"><span class="nav-number">2.15.</span> <span class="nav-text">before_action :authenticate_user!, except: :pay2go_cc_notify 的 except: :pay2go_cc_notify</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#lt-render-“pay-with-credit-card”-order-order-gt-的-order-order"><span class="nav-number">2.16.</span> <span class="nav-text"><%= render “pay_with_credit_card”, order: @order %> 的 order: @order</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#為什麼-pay-with-credit-card-這個-partial-在按下按鈕時能產生用信用卡付款的效果？"><span class="nav-number">2.17.</span> <span class="nav-text">為什麼 _pay_with_credit_card 這個 partial 在按下按鈕時能產生用信用卡付款的效果？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pay2go-cc-notify-method-是什麼時候被執行而能產生-callback-的效果？"><span class="nav-number">2.18.</span> <span class="nav-text">pay2go_cc_notify method 是什麼時候被執行而能產生 callback 的效果？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#lt-hidden-field-tag-“ReturnURL”-pay2go-cc-notify-order-url-order-token-gt"><span class="nav-number">2.19.</span> <span class="nav-text"><%= hidden_field_tag “ReturnURL”, pay2go_cc_notify_order_url(order.token) %></span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#if-params-“Status”-“SUCCESS”-是-Pay2go-API-回傳的資訊嗎？"><span class="nav-number">2.20.</span> <span class="nav-text">if params[“Status”] == “SUCCESS” 是 Pay2go API 回傳的資訊嗎？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#local-git-和-heroku-git-不同，要改的話，用下面的連結。"><span class="nav-number">2.21.</span> <span class="nav-text">local git 和 heroku git 不同，要改的話，用下面的連結。</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Deploy-到-Heroku"><span class="nav-number">3.</span> <span class="nav-text">Deploy 到 Heroku</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#gem-“pg”-是-heroku-指定的-database，並且必須限定在-production-下使用。"><span class="nav-number">3.1.</span> <span class="nav-text">gem “pg” 是 heroku 指定的 database，並且必須限定在 production 下使用。</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Gemfile-中，production-包在-development-test-這層-scope-內也能運作，但會有什麼影響呢？"><span class="nav-number">3.2.</span> <span class="nav-text">Gemfile 中，production 包在 development, test 這層 scope 內也能運作，但會有什麼影響呢？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#“因為我們還要測試在-heroku-的刷卡機制，所以先暫時把-production-裡的-pay2go-環境設定改成開發用”。這個修改對於-heroku-端有什麼影響？因為不是說程式部署到-heroku-會自動變成-production-模式嗎？"><span class="nav-number">3.3.</span> <span class="nav-text">“因為我們還要測試在 heroku 的刷卡機制，所以先暫時把 production 裡的 pay2go 環境設定改成開發用”。這個修改對於 heroku 端有什麼影響？因為不是說程式部署到 heroku 會自動變成 production 模式嗎？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Deploying-with-git-https-devcenter-heroku-com-articles-git"><span class="nav-number">3.4.</span> <span class="nav-text">Deploying with git https://devcenter.heroku.com/articles/git</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Deploy-補充-環境架構解說"><span class="nav-number">4.</span> <span class="nav-text">Deploy 補充 - 環境架構解說</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#用-figaro-管理機密資訊"><span class="nav-number">5.</span> <span class="nav-text">用 figaro 管理機密資訊</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#拆解下面這段"><span class="nav-number">5.1.</span> <span class="nav-text">拆解下面這段</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#只要有新增、修改帳號密碼，就要跑-figaro-heroku-set-e-production-將最新的帳號密碼資訊傳到-heroku-去。"><span class="nav-number">5.2.</span> <span class="nav-text">只要有新增、修改帳號密碼，就要跑 figaro heroku:set -e production 將最新的帳號密碼資訊傳到 heroku 去。</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#什麼是環境變數？"><span class="nav-number">5.3.</span> <span class="nav-text">什麼是環境變數？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#application-yml-中的-pay2go-merchant-id-quot-197-quot-VS-pay2go-rb-中的-pay2go-merchant-id-ENV-39-pay2go-merchant-id-39-，這兩種寫法是-conventions-還是-figaro-要求的？"><span class="nav-number">5.4.</span> <span class="nav-text">application.yml 中的 pay2go_merchant_id: "197----" VS pay2go.rb 中的 pay2go.merchant_id = ENV['pay2go_merchant_id']，這兩種寫法是 conventions 還是 figaro 要求的？</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#更多開發技巧"><span class="nav-number">6.</span> <span class="nav-text">更多開發技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#為什麼-rake-T-列出的清單中沒有-rake-db-reset"><span class="nav-number">6.1.</span> <span class="nav-text">為什麼 rake -T 列出的清單中沒有 rake db:reset?</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#基本收納術"><span class="nav-number">7.</span> <span class="nav-text">基本收納術</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#為什麼-tokenable-rb-是放在-app-models-concerns-A-K-A-How-to-use-concerns-in-Rails-4"><span class="nav-number">7.1.</span> <span class="nav-text">為什麼 tokenable.rb 是放在 app/models/concerns?  A.K.A. How to use concerns in Rails 4 ?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#“一般-module-不認識-before-create，用-Rails-Model-Concern”。為什麼一般-module-不認識-before-create-concerns-分多少種？"><span class="nav-number">7.2.</span> <span class="nav-text">“一般 module 不認識 before_create，用 Rails : Model Concern”。為什麼一般 module 不認識 before_create ? concerns 分多少種？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#拆解下方："><span class="nav-number">7.3.</span> <span class="nav-text">拆解下方：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#View-收納術"><span class="nav-number">8.</span> <span class="nav-text">View 收納術</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ServiceObject"><span class="nav-number">9.</span> <span class="nav-text">ServiceObject</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#各個檔案裡的-method-是怎麼被找到的？比如說我們在-app-services-order-placing-service-rb-有一個-OrderPlacingService-class，底下有一個叫-place-order-的-method，然後我們在-app-controllers-orders-controller-rb-裡面用到-OrderPlacingService-new-current-cart-order-place-order-，請問是怎麼找到的？"><span class="nav-number">9.1.</span> <span class="nav-text">各個檔案裡的 method 是怎麼被找到的？比如說我們在 app/services/order_placing_service.rb 有一個 OrderPlacingService class，底下有一個叫 place_order! 的 method，然後我們在 app/controllers/orders_controller.rb 裡面用到 OrderPlacingService.new(current_cart, @order).place_order!，請問是怎麼找到的？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#可不可以說，service-objects-給-controller-用、concerns-給-model-用-partial-給-view-用？helper-在-MVC-三個都可以用？"><span class="nav-number">9.2.</span> <span class="nav-text">可不可以說，service objects 給 controller 用、concerns 給 model 用 partial 給 view 用？helper 在 MVC 三個都可以用？</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#其他"><span class="nav-number">10.</span> <span class="nav-text">其他</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#放-gem-進去-Gemfile-時，實務上會加上版本號嗎？"><span class="nav-number">10.1.</span> <span class="nav-text">放 gem 進去 Gemfile 時，實務上會加上版本號嗎？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#golden-circle-why-how-what"><span class="nav-number">10.2.</span> <span class="nav-text">golden circle: why, how ,what?</span></a></li></ol></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jason Lung</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'hexo-github-pages-lionlies';
      var disqus_identifier = '2016/09/18/Rails-EC-Week-3/';
      var disqus_title = "Rails EC Week 3";
      var disqus_url = 'http://yoursite.com/2016/09/18/Rails-EC-Week-3/';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
        var disqus_config = function () {
            this.page.url = disqus_url;
            this.page.identifier = disqus_identifier;
            this.page.title = disqus_title;
        };
        run_disqus_script('embed.js');
      
    </script>
  




  
  

  

  

  

  


</body>
</html>
